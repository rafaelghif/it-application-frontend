import{D as b,Q as j,r as c,j as t,H as p,L as x,N as h,R as w,_ as A,S as E,T as M,U as q,V as R,W as I,I as f,aj as k}from"./index-2e6015fe.js";import{T as O}from"./Table-31cc959a.js";import{f as P}from"./date-fns-2338d0ca.js";import{C as U}from"./Card-89e3a3b1.js";import{u as _}from"./useQuery-126fcc4d.js";import{c as F,a as L,d as N,u as g,b as S}from"./useToast-38e41910.js";import{M as v}from"./Modal-e69a7e9c.js";const C="/sub-category",Q=async n=>{try{return(await F("".concat(C,"/categoryId/").concat(n))).data}catch(e){throw e}},B=async n=>{try{return(await L("".concat(C,"/"),n)).message}catch(e){throw e}},$=async n=>{try{return(await N("".concat(C,"/"),n)).message}catch(e){throw e}},V=n=>{const{setLoading:e}=b(),{errorToast:o}=g();return _({queryKey:["sub-categories",{categoryId:n}],queryFn:()=>Q(n),onError:async s=>{o(s),e(!1)},onSettled:async()=>{e(!1)},refetchOnWindowFocus:!1,retry:!1})},K=n=>{const e=j(),{setLoading:o}=b(),{successToast:s,errorToast:l}=g();return S({mutationFn:a=>B(a),onMutate:()=>{o(!0)},onError:async a=>{o(!1),l(a)},onSuccess:async a=>{s(a),e.invalidateQueries({queryKey:["sub-categories",{categoryId:n}]})},onSettled:()=>{o(!1)}})},z=({isOpen:n,categoryId:e="",onDidDismiss:o})=>{const[s,l]=c.useState({name:"",CategoryId:e}),{mutate:a}=K(e),i=(r,u)=>{l(m=>({...m,[r]:u}))},d=r=>{r.preventDefault(),a(s),l(u=>({...u,name:""})),o()};return c.useEffect(()=>{l(r=>({...r,CategoryId:e}))},[e]),t.jsx(v,{title:"Create Sub Category",isOpen:n,onDidDismiss:o,children:t.jsxs("form",{onSubmit:d,children:[t.jsx(p,{children:t.jsx(x,{type:"text",label:"Category Id",labelPlacement:"floating",value:s.CategoryId,onIonInput:r=>i("CategoryId",r.detail.value),disabled:!0,required:!0})}),t.jsx(p,{children:t.jsx(x,{type:"text",label:"Name",labelPlacement:"floating",value:s.name,onIonInput:r=>i("name",r.detail.value),required:!0})}),t.jsx(h,{type:"submit",expand:"block",children:"Submit"})]})})},G=n=>{const e=j(),{setLoading:o}=b(),{successToast:s,errorToast:l}=g();return S({mutationFn:a=>$(a),onMutate:()=>{o(!0)},onError:async a=>{o(!1),l(a)},onSuccess:async a=>{s(a),e.invalidateQueries({queryKey:["sub-categories",{categoryId:n}]})},onSettled:()=>{o(!1)}})},H=({isOpen:n,data:e,onDidDismiss:o})=>{const[s,l]=c.useState({}),{mutate:a}=G((e==null?void 0:e.CategoryId)||""),i=(r,u)=>{l(m=>({...m,[r]:u}))},d=r=>{r.preventDefault(),a(s),o()};return c.useEffect(()=>{l(r=>({...r,id:e==null?void 0:e.id,name:e==null?void 0:e.name,inActive:e==null?void 0:e.inActive,CategoryId:e==null?void 0:e.CategoryId}))},[e]),t.jsx(v,{title:"Update Sub Category",isOpen:n,onDidDismiss:o,children:t.jsxs("form",{onSubmit:d,children:[t.jsx(p,{children:t.jsx(x,{type:"text",label:"Id",labelPlacement:"floating",value:s==null?void 0:s.id,onIonInput:r=>i("id",r.detail.value),required:!0,disabled:!0})}),t.jsx(p,{children:t.jsx(x,{type:"text",label:"Category Id",labelPlacement:"floating",value:s==null?void 0:s.CategoryId,onIonInput:r=>i("CategoryId",r.detail.value),required:!0,disabled:!0})}),t.jsx(p,{children:t.jsx(x,{type:"text",label:"Name",labelPlacement:"floating",value:s==null?void 0:s.name,onIonInput:r=>i("name",r.detail.value),required:!0})}),t.jsx(p,{children:t.jsx(w,{checked:s==null?void 0:s.inActive,onIonChange:r=>i("inActive",r.detail.checked),children:"InActive"})}),t.jsx(h,{type:"submit",expand:"block",children:"Submit"})]})})},W=c.lazy(()=>A(()=>import("./TableSubCategory-cfcc78cd.js"),["assets/TableSubCategory-cfcc78cd.js","assets/index-2e6015fe.js","assets/index-30953d8c.css","assets/Table-31cc959a.js","assets/date-fns-2338d0ca.js"])),D=({data:n})=>{const{data:e,isLoading:o,refetch:s}=V(n.id),[l,a]=c.useState(),[i,d]=c.useState(!1),[r,u]=c.useState(!1),m=y=>{a(y),u(!0)},T=async y=>{s(),y.detail.complete()};return t.jsxs(t.Fragment,{children:[t.jsx(E,{slot:"fixed",onIonRefresh:T,children:t.jsx(M,{})}),t.jsx(q,{children:t.jsxs(R,{children:[t.jsx(I,{size:"12",children:t.jsx(h,{fill:"clear",onClick:()=>d(!0),className:"float-right",children:"Create Sub Category"})}),t.jsx(I,{children:t.jsx(U,{title:"Data Category ".concat(n.name),headerColor:"light",children:o?t.jsx(f,{name:"crescent"}):t.jsx(c.Suspense,{fallback:t.jsx(f,{name:"crescent"}),children:t.jsx(W,{data:e,handleClickBtnEdit:y=>m(y)})})})})]})}),t.jsx(z,{categoryId:n.id,isOpen:i,onDidDismiss:()=>d(!1)}),t.jsx(H,{data:l,isOpen:r,onDidDismiss:()=>u(!1)})]})},re=({data:n=[],handleClickBtnEdit:e})=>{const o=c.useMemo(()=>[{name:"Name",selector:s=>s.name,sortable:!0,grow:2,wrap:!0},{name:"Status",cell:s=>t.jsx(k,{color:s.inActive?"danger":"success",children:s.inActive?"InActive":"Active"}),sortable:!0},{name:"Update By",selector:s=>s.updatedBy,sortable:!0},{name:"Update At",selector:s=>P(s.updatedAt),sortable:!0,wrap:!0},{name:"Edit",cell:s=>t.jsx(h,{fill:"clear",color:"warning",onClick:()=>{e(s)},children:"Edit"}),center:!0}],[e]);return t.jsx(O,{columns:o,data:n,responsive:!0,pagination:!0,striped:!0,highlightOnHover:!0,expandableRows:!0,expandableRowsComponent:D})};export{re as default};
