import{D as b,Q as v,r as c,j as t,H as d,L as m,R as C,N as I,_ as T,S as q,T as A,U as M,V as D,W as f,I as y,aj as E}from"./index-371e0479.js";import{T as R}from"./Table-eb48f3b9.js";import{f as k}from"./date-fns-2338d0ca.js";import{C as O}from"./Card-3edec102.js";import{u as P}from"./useQuery-85112495.js";import{u as j,b as g}from"./useToast-7daec343.js";import{g as w,u as U,c as _}from"./location-service-7556d11c.js";import{M as L}from"./Modal-05a5b31d.js";const F=a=>{const{setLoading:n}=b(),{errorToast:o}=j();return P({queryKey:["locations",{departmentId:a}],queryFn:()=>w(a),onError:async e=>{o(e),n(!1)},onSettled:async()=>{n(!1)},refetchOnWindowFocus:!1,retry:!1})},B=a=>{const n=v(),{setLoading:o}=b(),{successToast:e,errorToast:l}=j();return g({mutationFn:r=>U(r),onMutate:()=>{o(!0)},onError:async r=>{o(!1),l(r)},onSuccess:async r=>{e(r),n.invalidateQueries({queryKey:["locations",{departmentId:a}]})},onSettled:()=>{o(!1)}})},Q=({isOpen:a,data:n,onDidDismiss:o})=>{const[e,l]=c.useState({}),{mutate:r}=B(e.DepartmentId||""),i=(s,u)=>{l(x=>({...x,[s]:u}))},p=s=>{s.preventDefault(),r(e),o()};return c.useEffect(()=>{l(s=>({...s,id:n==null?void 0:n.id,name:n==null?void 0:n.name,lot:n==null?void 0:n.lot,inActive:n==null?void 0:n.inActive,DepartmentId:n==null?void 0:n.DepartmentId}))},[n]),t.jsx(L,{title:"Update Location",isOpen:a,onDidDismiss:o,children:t.jsxs("form",{onSubmit:p,children:[t.jsx(d,{children:t.jsx(m,{type:"text",label:"Id",labelPlacement:"floating",value:e==null?void 0:e.id,onIonInput:s=>i("id",s.detail.value),required:!0,disabled:!0})}),t.jsx(d,{children:t.jsx(m,{type:"text",label:"Department Id",labelPlacement:"floating",value:e==null?void 0:e.DepartmentId,onIonInput:s=>i("DepartmentId",s.detail.value),required:!0,disabled:!0})}),t.jsx(d,{children:t.jsx(m,{type:"text",label:"Name",labelPlacement:"floating",value:e==null?void 0:e.name,onIonInput:s=>i("name",s.detail.value),required:!0})}),t.jsx(d,{children:t.jsx(m,{type:"text",label:"Lot",labelPlacement:"floating",value:e==null?void 0:e.lot,onIonInput:s=>i("lot",s.detail.value),required:!0})}),t.jsx(d,{children:t.jsx(C,{checked:e==null?void 0:e.inActive,onIonChange:s=>i("inActive",s.detail.checked),children:"InActive"})}),t.jsx(I,{type:"submit",expand:"block",children:"Submit"})]})})},N=a=>{const n=v(),{setLoading:o}=b(),{successToast:e,errorToast:l}=j();return g({mutationFn:r=>_(r),onMutate:()=>{o(!0)},onError:async r=>{o(!1),l(r)},onSuccess:async r=>{e(r),n.invalidateQueries({queryKey:["locations",{departmentId:a}]})},onSettled:()=>{o(!1)}})},V=({isOpen:a,departmentId:n,onDidDismiss:o})=>{const[e,l]=c.useState({name:"",lot:"",DepartmentId:n}),{mutate:r}=N(n),i=(s,u)=>{l(x=>({...x,[s]:u}))},p=s=>{s.preventDefault(),r(e),l(u=>({...u,name:""})),o()};return t.jsx(L,{title:"Create Location",isOpen:a,onDidDismiss:o,children:t.jsxs("form",{onSubmit:p,children:[t.jsx(d,{children:t.jsx(m,{type:"text",label:"Department Id",labelPlacement:"floating",value:e.DepartmentId,onIonInput:s=>i("DepartmentId",s.detail.value),disabled:!0,required:!0})}),t.jsx(d,{children:t.jsx(m,{type:"text",label:"Name",labelPlacement:"floating",value:e.name,onIonInput:s=>i("name",s.detail.value),required:!0})}),t.jsx(d,{children:t.jsx(m,{type:"text",label:"Lot",labelPlacement:"floating",value:e.lot,onIonInput:s=>i("lot",s.detail.value),required:!0})}),t.jsx(I,{type:"submit",expand:"block",children:"Submit"})]})})},K=c.lazy(()=>T(()=>import("./TableLocation-9169b32c.js"),["assets/TableLocation-9169b32c.js","assets/index-371e0479.js","assets/index-aeb37fef.css","assets/Table-eb48f3b9.js","assets/date-fns-2338d0ca.js"])),z=({data:a})=>{const{data:n,isLoading:o,refetch:e}=F(a.id),[l,r]=c.useState(),[i,p]=c.useState(!1),[s,u]=c.useState(!1),x=h=>{r(h),u(!0)},S=async h=>{e(),h.detail.complete()};return t.jsxs(t.Fragment,{children:[t.jsx(q,{slot:"fixed",onIonRefresh:S,children:t.jsx(A,{})}),t.jsx(M,{children:t.jsxs(D,{children:[t.jsx(f,{size:"12",children:t.jsx(I,{fill:"clear",onClick:()=>p(!0),className:"float-right",children:"Create Location"})}),t.jsx(f,{children:t.jsx(O,{title:"Data Location ".concat(a.name),headerColor:"light",children:o?t.jsx(y,{name:"crescent"}):t.jsx(c.Suspense,{fallback:t.jsx(y,{name:"crescent"}),children:t.jsx(K,{data:n,handleClickBtnEdit:h=>x(h)})})})})]})}),t.jsx(V,{departmentId:a.id,isOpen:i,onDidDismiss:()=>p(!1)}),t.jsx(Q,{data:l,isOpen:s,onDidDismiss:()=>u(!1)})]})},ee=({data:a=[],handleClickBtnEdit:n})=>{const o=c.useMemo(()=>[{name:"Name",selector:e=>e.name,sortable:!0,grow:2,wrap:!0},{name:"Abbreviation",selector:e=>e.abbreviation,sortable:!0,wrap:!0},{name:"Status",cell:e=>t.jsx(E,{color:e.inActive?"danger":"success",children:e.inActive?"InActive":"Active"}),sortable:!0},{name:"Update By",selector:e=>e.updatedBy,sortable:!0},{name:"Update At",selector:e=>k(e.updatedAt),sortable:!0,wrap:!0},{name:"Edit",cell:e=>t.jsx(I,{fill:"clear",color:"warning",onClick:()=>{n(e)},children:"Edit"}),center:!0}],[n]);return t.jsx(R,{columns:o,data:a,responsive:!0,pagination:!0,striped:!0,highlightOnHover:!0,expandableRows:!0,expandableRowsComponent:z})};export{ee as default};
