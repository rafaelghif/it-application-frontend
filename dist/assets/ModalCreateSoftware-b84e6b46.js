import{Q as f,D as I,r as S,j as t,H as o,L as u,X as h,Y as p,$ as v,N as j}from"./index-371e0479.js";import{M as y}from"./Modal-05a5b31d.js";import{u as D,b as g}from"./useToast-7daec343.js";import{c as T}from"./software-service-c37b1dc1.js";import{a as P}from"./date-fns-2338d0ca.js";const C=()=>{const c=f(),{setLoading:s}=I(),{successToast:a,errorToast:n}=D();return g({mutationFn:r=>T(r),onMutate:()=>{s(!0)},onError:async r=>{s(!1),n(r)},onSuccess:async r=>{a(r),c.invalidateQueries({queryKey:["softwares"]})},onSettled:()=>{s(!1)}})},E=({isOpen:c,onDidDismiss:s})=>{const[a,n]=S.useState({name:"",version:"",licenseType:"Subscription",startDate:"",expireDate:"",remark:""}),{mutate:r}=C(),i=(e,l)=>{n(b=>({...b,[e]:l}))},d=e=>{n(l=>({...l,licenseType:e,startDate:"",expireDate:""}))},m=e=>{a.licenseType==="Subscription"?n(l=>({...l,startDate:e,expireDate:P(e,1)})):n(l=>({...l,startDate:e}))},x=e=>{e.preventDefault(),r(a),n({name:"",version:"",licenseType:"Subscription",startDate:"",expireDate:"",remark:""}),s()};return t.jsx(y,{title:"Create Software",isOpen:c,onDidDismiss:s,children:t.jsxs("form",{onSubmit:x,children:[t.jsx(o,{children:t.jsx(u,{type:"text",label:"Name",labelPlacement:"floating",value:a.name,onIonInput:e=>i("name",e.detail.value),required:!0})}),t.jsx(o,{children:t.jsx(u,{type:"text",label:"Version",labelPlacement:"floating",value:a.version,onIonInput:e=>i("version",e.detail.value),required:!0})}),t.jsx(o,{children:t.jsxs(h,{label:"License Type",labelPlacement:"floating",value:a.licenseType,onIonChange:e=>d(e.detail.value),children:[t.jsx(p,{value:"Subscription",children:"Subscription"}),t.jsx(p,{value:"Perpetual",children:"Perpetual"})]})}),t.jsx(o,{children:t.jsx(u,{type:"date",label:"Start Date / Purchase Date",labelPlacement:"floating",value:a.startDate,onIonInput:e=>m(e.detail.value),required:!0})}),t.jsx(o,{hidden:a.licenseType==="Perpetual",children:t.jsx(u,{type:"date",label:"Expire Date",labelPlacement:"floating",value:a.expireDate,onIonInput:e=>i("expireDate",e.detail.value)})}),t.jsx(o,{children:t.jsx(v,{label:"Remark",labelPlacement:"floating",value:a.remark,onIonInput:e=>i("remark",e.detail.value),required:!0})}),t.jsx(j,{type:"submit",expand:"block",children:"Submit"})]})})};export{E as default};
