import{Q as v,D as y,r,_ as b,j as e,H as a,L as d,I as j,R as S,N as P,S as g,T as _,U as C,V as E,W as m,Z as N}from"./index-2e6015fe.js";import{C as R}from"./Card-89e3a3b1.js";import{M as k}from"./Modal-e69a7e9c.js";import{u as f,b as T}from"./useToast-38e41910.js";import{u as A,g as L}from"./phone-service-733a040d.js";import{u as M}from"./useQuery-126fcc4d.js";const U=()=>{const l=v(),{setLoading:n}=y(),{successToast:i,errorToast:s}=f();return T({mutationFn:o=>A(o),onMutate:()=>{n(!0)},onError:async o=>{n(!1),s(o)},onSuccess:async o=>{i(o),l.invalidateQueries({queryKey:["phones"]})},onSettled:()=>{n(!1)}})},q=r.lazy(()=>b(()=>import("./SelectDepartment-5601e28f.js"),["assets/SelectDepartment-5601e28f.js","assets/index-2e6015fe.js","assets/index-30953d8c.css","assets/useQuery-126fcc4d.js","assets/useToast-38e41910.js","assets/department-service-cd71fa07.js"])),O=({isOpen:l,data:n,onDidDismiss:i})=>{const[s,o]=r.useState({}),{mutate:p}=U(),c=(t,x)=>{o(I=>({...I,[t]:x}))},h=t=>{t.preventDefault(),p(s),i()};return r.useEffect(()=>{o(t=>({...t,id:n==null?void 0:n.id,name:n==null?void 0:n.name,extNo:n==null?void 0:n.extNo,speedDialNo:n==null?void 0:n.speedDialNo,inActive:n==null?void 0:n.inActive,DepartmentId:n==null?void 0:n.DepartmentId}))},[n]),e.jsx(k,{title:"Update Phone",isOpen:l,onDidDismiss:i,children:e.jsxs("form",{onSubmit:h,children:[e.jsx(a,{children:e.jsx(d,{type:"text",label:"Id",labelPlacement:"floating",value:s==null?void 0:s.id,onIonInput:t=>c("id",t.detail.value),disabled:!0,required:!0})}),e.jsx(a,{children:e.jsx(d,{type:"text",label:"UserName",labelPlacement:"floating",value:s==null?void 0:s.name,onIonInput:t=>c("name",t.detail.value),required:!0})}),e.jsx(a,{children:e.jsx(d,{type:"text",label:"Ext No",labelPlacement:"floating",value:s==null?void 0:s.extNo,onIonInput:t=>c("extNo",t.detail.value)})}),e.jsx(a,{children:e.jsx(d,{type:"text",label:"Speed Dial No",labelPlacement:"floating",value:s==null?void 0:s.speedDialNo,onIonInput:t=>c("speedDialNo",t.detail.value)})}),e.jsx(r.Suspense,{fallback:e.jsx(j,{name:"crescent"}),children:e.jsx(q,{value:s==null?void 0:s.DepartmentId,onChange:t=>c("DepartmentId",t)})}),e.jsx(a,{children:e.jsx(S,{checked:s==null?void 0:s.inActive,onIonChange:t=>c("inActive",t.detail.checked),children:"InActive"})}),e.jsx(P,{type:"submit",expand:"block",children:"Submit"})]})})},D=l=>{const{setLoading:n}=y(),{errorToast:i}=f();return M({queryKey:["phones",{search:l}],queryFn:()=>L(l),onError:async s=>{i(s),n(!1)},onSettled:async()=>{n(!1)},refetchOnWindowFocus:!1,retry:!1})},F=r.lazy(()=>b(()=>import("./TablePhone-285c23bb.js"),["assets/TablePhone-285c23bb.js","assets/index-2e6015fe.js","assets/index-30953d8c.css","assets/Table-31cc959a.js","assets/date-fns-2338d0ca.js"])),W=()=>{const[l,n]=r.useState(""),{data:i,isLoading:s,refetch:o}=D(l),[p,c]=r.useState(),[h,t]=r.useState(!1),x=u=>{c(u),t(!0)},I=async u=>{o(),u.detail.complete()};return e.jsxs(e.Fragment,{children:[e.jsx(g,{slot:"fixed",onIonRefresh:I,children:e.jsx(_,{})}),e.jsx(C,{children:e.jsxs(E,{children:[e.jsx(m,{size:"12",children:e.jsx(N,{value:l,onIonInput:u=>n(u.detail.value),debounce:1e3})}),e.jsx(m,{children:e.jsx(R,{title:"Data Phones",children:s?e.jsx(j,{name:"crescent"}):e.jsx(r.Suspense,{fallback:e.jsx(j,{name:"crescent"}),children:e.jsx(F,{data:i,handleClickBtnEdit:u=>x(u)})})})})]})}),e.jsx(O,{data:p,isOpen:h,onDidDismiss:()=>t(!1)})]})};export{W as default};
